. 　　　。　　　　•　 　ﾟ　　。 　　.

　　　.　　　 　　.　　　　　。　　 。　. 　

.　　 。　　　　　 ඞ 。 . 　　 • 　　　　•

　　ﾟ　　 Red was not An Impostor.　 。　.

　　'　　　 1 Impostor remains 　 　　。

　　ﾟ　　　.　　　. ,　　　　.　 .


# GAM (CSE185 Project)

This is Pei Ting Chua Chai and Omar Halawa's CSE185 project. It implements a subset of the the "--linear" GWAS method available through plink. See the [plink --linear](https://www.cog-genomics.org/plink/1.9/assoc#linear) page for more details.

# Install instructions

Installation requires the [`pandas`](https://pandas.pydata.org/), [`cyvcf2`](https://brentp.github.io/cyvcf2/), [`numpy`](https://numpy.org/) libraries to be installed. You can install these with `pip install` or `conda install`:

_**Important Note:**_ You  may experience some issues with installing `cyvcf2` via pip due to versioning discrepancies. As a result, it is _highly recommended_ you install it via conda.

```
pip install pandas
pip install numpy
conda install cyvcf2
```

Once required libraries are installed, you can install `gam` with the following command:

```
python setup.py install
```

Note: if you do not have root access, you can run the commands above with additional options to install locally:
```
pip install --user pandas numpy
conda install -p ~/.local cyvcf2
python setup.py install --user
```

If the install was successful, typing `gam --help` should show a useful message.

# Basic usage

The basic usage of `gam` is (uses the `--linear` option, one of the 3 available modes - see **gam options**):

```
gam -l -g genotype.vcf.gz -p phenotype.phen
```

To run `gam` on a small test example (using files in this repo):
```
TODO: gam -g example-files/test.vcf.gz -p example-files/test.phen
```

This should produce the following Manhattan plot below:
```
TODO:
```

To compare to output of `plink --linear`, run:
```
TODO:
```

# gam options

The only required inputs to `gam` are 

1. `-g GENOTYPE_FILE`, `--genotype GENOTYPE_FILE` as a **.vcf.gz** file (more file type implementation to come)
2. `-p PHENOTYPE_FILE`, `--phenotype PHENOTYPE_FILE` as a **.phen** file
3. Either _**one**_ of the three following modes:
* `-l`, `--linear` where GWAS with a normal linear-regression model is done
* `--le`, `--linear-ensemble` where GWAS is done using an ensemble of linear regression models
* `--bdt`, `--boosted` where GWAS is done using boosted decision trees to build the model
    



Users may additionally specify the options below:

* `-m FLOAT`, `--maf FLOAT`: float representing minor allele frequency. If specified, the script will perform further filtration on the dataset provided by excluding SNPs whose MAF values lie below the assigned threshold. 

* `-o FILE`, `--out FILE`: path to output result file(s). By default, the path is the current working directory.


# File format

The output file format, **.assoc.linear**, is the same as that of the `plink --linear` method. See [here](https://www.cog-genomics.org/plink/1.9/formats#assoc_linear) for more details.

# Contributors

This repository was generated by Pei Ting Chua Chai and Omar Halawa, with inspiration from the [CSE 185 Demo Project](https://github.com/gymreklab/cse185-demo-project), [GenePattern Random Forest](https://github.com/genepattern/RandomForest), and many other projects.

Please submit a pull request with any corrections or suggestions.

# Testing (work-in-progress)

To run tests:
```
# Run command line tests
TODO: sh tests/cmdline_tests.sh

# Run unit tests
TODO: python -m pytest --cov=.
```



